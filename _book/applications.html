<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Applications | Solver for Hydrologic Unstructured Domain (SHUD)</title>
  <meta name="description" content="SHUD User Guide" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Applications | Solver for Hydrologic Unstructured Domain (SHUD)" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="SHUD User Guide" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Applications | Solver for Hydrologic Unstructured Domain (SHUD)" />
  
  <meta name="twitter:description" content="SHUD User Guide" />
  

<meta name="author" content="Lele Shu (lele.shu@gmail.com)" />


<meta name="date" content="2019-12-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="output-files.html"/>
<link rel="next" href="calibration.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SHUD User Guide</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#standing-on-the-shoulders-of-giants"><i class="fa fa-check"></i><b>1.1</b> Standing on the shoulders of giants</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#brief-history-of-pihm-system"><i class="fa fa-check"></i><b>1.2</b> Brief History of PIHM system</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="install-shud-and-shudtoolbox.html"><a href="install-shud-and-shudtoolbox.html"><i class="fa fa-check"></i><b>2</b> Install SHUD and SHUDtoolbox</a><ul>
<li class="chapter" data-level="2.1" data-path="install-shud-and-shudtoolbox.html"><a href="install-shud-and-shudtoolbox.html#sundialscvode"><i class="fa fa-check"></i><b>2.1</b> SUNDIALS/CVODE</a></li>
<li class="chapter" data-level="2.2" data-path="install-shud-and-shudtoolbox.html"><a href="install-shud-and-shudtoolbox.html#shud"><i class="fa fa-check"></i><b>2.2</b> SHUD</a><ul>
<li class="chapter" data-level="2.2.1" data-path="install-shud-and-shudtoolbox.html"><a href="install-shud-and-shudtoolbox.html#openmp"><i class="fa fa-check"></i><b>2.2.1</b> OpenMP</a></li>
<li class="chapter" data-level="2.2.2" data-path="install-shud-and-shudtoolbox.html"><a href="install-shud-and-shudtoolbox.html#run-shud-executables."><i class="fa fa-check"></i><b>2.2.2</b> Run SHUD executables.</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="install-shud-and-shudtoolbox.html"><a href="install-shud-and-shudtoolbox.html#shudtoolbox"><i class="fa fa-check"></i><b>2.3</b> SHUDtoolbox</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="input-files.html"><a href="input-files.html"><i class="fa fa-check"></i><b>3</b> Input files</a><ul>
<li class="chapter" data-level="3.1" data-path="input-files.html"><a href="input-files.html#spatial-data"><i class="fa fa-check"></i><b>3.1</b> Spatial data</a><ul>
<li class="chapter" data-level="3.1.1" data-path="input-files.html"><a href="input-files.html#sp.mesh-file"><i class="fa fa-check"></i><b>3.1.1</b> .sp.mesh file</a></li>
<li class="chapter" data-level="3.1.2" data-path="input-files.html"><a href="input-files.html#sp.att-file"><i class="fa fa-check"></i><b>3.1.2</b> .sp.att file</a></li>
<li class="chapter" data-level="3.1.3" data-path="input-files.html"><a href="input-files.html#sp.riv-file"><i class="fa fa-check"></i><b>3.1.3</b> .sp.riv file</a></li>
<li class="chapter" data-level="3.1.4" data-path="input-files.html"><a href="input-files.html#sp.rivseg-file"><i class="fa fa-check"></i><b>3.1.4</b> .sp.rivseg file</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="input-files.html"><a href="input-files.html#model-configuration-files"><i class="fa fa-check"></i><b>3.2</b> Model configuration files</a><ul>
<li class="chapter" data-level="3.2.1" data-path="input-files.html"><a href="input-files.html#cfg.para-file"><i class="fa fa-check"></i><b>3.2.1</b> .cfg.para file</a></li>
<li class="chapter" data-level="3.2.2" data-path="input-files.html"><a href="input-files.html#cfg.calib-file"><i class="fa fa-check"></i><b>3.2.2</b> .cfg.calib file</a></li>
<li class="chapter" data-level="3.2.3" data-path="input-files.html"><a href="input-files.html#cfg.ic-file"><i class="fa fa-check"></i><b>3.2.3</b> .cfg.ic file</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="input-files.html"><a href="input-files.html#time-series-data"><i class="fa fa-check"></i><b>3.3</b> Time-series data</a><ul>
<li class="chapter" data-level="3.3.1" data-path="input-files.html"><a href="input-files.html#tsd.forc-file"><i class="fa fa-check"></i><b>3.3.1</b> .tsd.forc file</a></li>
<li class="chapter" data-level="3.3.2" data-path="input-files.html"><a href="input-files.html#tsd.lai-file"><i class="fa fa-check"></i><b>3.3.2</b> .tsd.lai file</a></li>
<li class="chapter" data-level="3.3.3" data-path="input-files.html"><a href="input-files.html#tsd.rl-file"><i class="fa fa-check"></i><b>3.3.3</b> .tsd.rl file</a></li>
<li class="chapter" data-level="3.3.4" data-path="input-files.html"><a href="input-files.html#tsd.mf-file"><i class="fa fa-check"></i><b>3.3.4</b> .tsd.mf file</a></li>
<li class="chapter" data-level="3.3.5" data-path="input-files.html"><a href="input-files.html#tsd.obs-file"><i class="fa fa-check"></i><b>3.3.5</b> .tsd.obs file</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="output-files.html"><a href="output-files.html"><i class="fa fa-check"></i><b>4</b> Output files</a><ul>
<li class="chapter" data-level="4.1" data-path="output-files.html"><a href="output-files.html#output-file-names"><i class="fa fa-check"></i><b>4.1</b> Output file names</a></li>
<li class="chapter" data-level="4.2" data-path="output-files.html"><a href="output-files.html#data-format-in-ascii-.csv-file"><i class="fa fa-check"></i><b>4.2</b> Data format in ASCII (.csv) file</a></li>
<li class="chapter" data-level="4.3" data-path="output-files.html"><a href="output-files.html#data-format-in-binary-.dat-file"><i class="fa fa-check"></i><b>4.3</b> Data format in binary (.dat) file</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>5</b> Applications</a><ul>
<li class="chapter" data-level="5.1" data-path="applications.html"><a href="applications.html#example-1-v-catchment"><i class="fa fa-check"></i><b>5.1</b> Example 1: V-Catchment</a><ul>
<li class="chapter" data-level="5.1.1" data-path="applications.html"><a href="applications.html#shen2010-result"><i class="fa fa-check"></i><b>5.1.1</b> Shen(2010) result</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="applications.html"><a href="applications.html#example-2-vauclin-experiment"><i class="fa fa-check"></i><b>5.2</b> Example 2: Vauclin Experiment</a></li>
<li class="chapter" data-level="5.3" data-path="applications.html"><a href="applications.html#example-3-cache-creek-watershed"><i class="fa fa-check"></i><b>5.3</b> Example 3: Cache Creek Watershed</a><ul>
<li class="chapter" data-level="5.3.1" data-path="applications.html"><a href="applications.html#cache-creek-watershed"><i class="fa fa-check"></i><b>5.3.1</b> Cache Creek Watershed</a></li>
<li class="chapter" data-level="5.3.2" data-path="applications.html"><a href="applications.html#shud-simulation-and-calibration"><i class="fa fa-check"></i><b>5.3.2</b> SHUD simulation and calibration</a></li>
<li class="chapter" data-level="5.3.3" data-path="applications.html"><a href="applications.html#results"><i class="fa fa-check"></i><b>5.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="applications.html"><a href="applications.html#example-4-flashy-flood-in-yanhua-village-ningxia-china-on-september-2018"><i class="fa fa-check"></i><b>5.4</b> Example 4: Flashy flood in Yanhua Village, Ningxia, China on September 2018</a></li>
<li class="chapter" data-level="5.5" data-path="applications.html"><a href="applications.html#example-5-flood-inundation-in-houston-during-harvey-hurricane-2017"><i class="fa fa-check"></i><b>5.5</b> Example 5: Flood inundation in Houston during Harvey Hurricane 2017</a></li>
<li class="chapter" data-level="5.6" data-path="applications.html"><a href="applications.html#example-6-watershed-in-south-sudan"><i class="fa fa-check"></i><b>5.6</b> Example 6: Watershed in South Sudan</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="calibration.html"><a href="calibration.html"><i class="fa fa-check"></i><b>6</b> Calibration</a></li>
<li class="chapter" data-level="7" data-path="quick-reproducible-and-automatic-hydrological-modeling.html"><a href="quick-reproducible-and-automatic-hydrological-modeling.html"><i class="fa fa-check"></i><b>7</b> Quick, Reproducible and Automatic hydrological modeling</a><ul>
<li class="chapter" data-level="7.1" data-path="quick-reproducible-and-automatic-hydrological-modeling.html"><a href="quick-reproducible-and-automatic-hydrological-modeling.html#steps-of-modeling-with-shud"><i class="fa fa-check"></i><b>7.1</b> Steps of modeling with SHUD</a><ul>
<li class="chapter" data-level="7.1.1" data-path="quick-reproducible-and-automatic-hydrological-modeling.html"><a href="quick-reproducible-and-automatic-hydrological-modeling.html#essential-terrestrial-variables"><i class="fa fa-check"></i><b>7.1.1</b> Essential Terrestrial Variables?</a></li>
<li class="chapter" data-level="7.1.2" data-path="quick-reproducible-and-automatic-hydrological-modeling.html"><a href="quick-reproducible-and-automatic-hydrological-modeling.html#a-priori-data-sources"><i class="fa fa-check"></i><b>7.1.2</b> A-Priori Data Sources</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="quick-reproducible-and-automatic-hydrological-modeling.html"><a href="quick-reproducible-and-automatic-hydrological-modeling.html#workflow-of-shud-modeling-system"><i class="fa fa-check"></i><b>7.2</b> Workflow of SHUD Modeling System</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="source-code-and-program-design.html"><a href="source-code-and-program-design.html"><i class="fa fa-check"></i><b>8</b> Source code and program design</a></li>
<li class="divider"></li>
<li><a href="mailto:<Lele Shu>lele.shu@gmail.com" target="blank">Contact us</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Solver for Hydrologic Unstructured Domain (SHUD)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="applications" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Applications</h1>
<p>Some <em>significant</em> applications are demonstrated in this chapter.</p>
<p><strong>Best practice suggestions</strong> 1. Derive and QC all inputs (time mean, accumulation, screen fo anormalies …) 1. Conduct offline simulations … 1. Start with ‘idealized’ forcing (Option FORC_debug=1 in .cfg.para file). Which will use uniform forcing data to drive the hydrologic simulations. 1. Run with short time period, load the outputs and examine whether results are in expection 1. If all above works, then hook all modules and run with your forcing data.</p>

<div id="example-1-v-catchment" class="section level2">
<h2><span class="header-section-number">5.1</span> Example 1: V-Catchment</h2>
<p>Code annd data are available at <a href="https://zenodo.org/badge/latestdoi/226266189"><img src="https://zenodo.org/badge/226266189.svg" alt="DOI" /></a> or <a href="https://github.com/Model-Intercomparison-Datasets/V-Catchment">Github: https://github.com/Model-Intercomparison-Datasets/V-Catchment</a></p>
<p>The V-Catchment (VC) experiment is a standard test case for numerical hydrological models to validate their performance for overland flow along a hillslope and in the presence of a river channel. The VC domain consists of two inclined planes draining into a sloping channel.</p>
<div class="figure">
<img src="Fig/Example/vCat/Vcat.png" alt="Description of the V-Catchmenet" />
<p class="caption">Description of the V-Catchmenet</p>
</div>
<p>Both hillslopes are <span class="math inline">\(800 \times 1000 m\)</span> with Manning’s roughness <span class="math inline">\(n=0.015\)</span>. The river channel between the hillslopes is <span class="math inline">\(20\)</span> m wide and <span class="math inline">\(1000\)</span> m in length with <span class="math inline">\(n=0.15\)</span>. The slope from the ridge to the river channel is 0.05 (in the <span class="math inline">\(x\)</span> direction), and the longitudinal slope (in the <span class="math inline">\(y\)</span> direction) is 0.02.</p>
<p>Rainfall in the VC begins at time zero at a constant rate of <span class="math inline">\(18 mm/hr\)</span> and stops after 90 min, producing <span class="math inline">\(27\)</span> mm of accumulated precipitation. Since evaporation and infiltration is not involved in this simulation, the total outflow from lateral boundaries and the river outlet must be the same as the total precipitation (following conservation of mass).</p>
<div id="shen2010-result" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Shen(2010) result</h3>
<p>I use SHUD model to repeat the VC experiment, there are several literatures did the same experiment, but only Shen(2010) export the flux on side-plane which is also useful to validate the modeling algorithm.</p>
<div class="figure">
<img src="Fig/Example/vCat/Shen2010.png" alt="Shen (2010) results" />
<p class="caption">Shen (2010) results</p>
</div>
<p>However, the value of volume flux of side-plane in Shen(2010) is problematic. Lets explain: based on the Continuity Law, the total input (precipitation) must be equal to output (side-plane flow) or discharge (outlet flow). But the side-plane flux in Shen (2010) is 20 times less than the discharge. I assume Shen made a wrong unit conversion somehow. When I enlarge the side-plane flux by 20, the flux rate and accumulated flux are rational. I tried to contact Shen, but he didn’t reply with explanation, so I continue the work with my understanding.</p>
<div class="figure">
<img src="Fig/Example/vCat/vc_mesh.png" alt="SHUD triangular model domain in V-Catchment" />
<p class="caption">SHUD triangular model domain in V-Catchment</p>
</div>
<p>The result figure below also supports my thought. The side-plane flux in the result figure is the modified value (Shen’s side-plane flux times 20). Both flow rate meet the Continuity Law. So, I think this is the right interpretation of Shen’s result.</p>
<div class="figure">
<img src="Fig/Example/vCat/vcat_vs_vs.png" alt="Comparizon of SHUD modeling results versus Shen (2010)." />
<p class="caption">Comparizon of SHUD modeling results versus Shen (2010).</p>
</div>

</div>
</div>
<div id="example-2-vauclin-experiment" class="section level2">
<h2><span class="header-section-number">5.2</span> Example 2: Vauclin Experiment</h2>
<p>Code annd data are available at <a href="https://zenodo.org/badge/latestdoi/226266864"><img src="https://zenodo.org/badge/226266864.svg" alt="DOI" /></a> or <a href="https://github.com/Model-Intercomparison-Datasets/Vauclin1979">Github: https://github.com/Model-Intercomparison-Datasets/Vauclin1979</a>.</p>
<p>Vauclin’s experiment  is designed to assess groundwater table change and soil moisture in the unsaturated layer under precipitation or irrigation. The experiment was conducted in a sandbox with dimension <span class="math inline">\(3\)</span> m long <span class="math inline">\(\times 2\)</span> m deep <span class="math inline">\(\times 0.05\)</span> m wide (see Fig. ). The box was filled with uniform sand particles with measured hydraulic parameters: the saturated hydraulic conductivity was <span class="math inline">\(35\)</span> cm/hr and porosity was <span class="math inline">\(0.33\)</span> m<span class="math inline">\(^3\)</span>/m<span class="math inline">\(^3\)</span>. The left and bottom of the sandbox were impervious layers, and the top and the right side were open. A hydraulic head was set constant at <span class="math inline">\(0.65 m\)</span>. Constant irrigation (<span class="math inline">\(1.48\)</span> cm/hr) was applied over the first <span class="math inline">\(50\)</span> cm of the top-left of the sandbox while the rest of the top was covered to avoid water loss via evaporation.</p>
<div class="figure">
<img src="Fig/Example/Vauclin/Vauclin.png" alt="Experiment set-up in Vauclin (1979)" />
<p class="caption">Experiment set-up in Vauclin (1979)</p>
</div>
<div class="figure">
<img src="Fig/Example/Vauclin/v1.png" alt="Groundwater measurement and 2-D numeric simulation in Vauclin (1979)" />
<p class="caption">Groundwater measurement and 2-D numeric simulation in Vauclin (1979)</p>
</div>
<p>The experiment’s initial condition is an equilibrium water table under constant hydraulic head from the right side. That is, the saturated water table across the sandbox was kept stable at <span class="math inline">\(0.65\)</span> m. When the groundwater table reached equilibrium, irrigation was initiated at <span class="math inline">\(t = 0\)</span>. The groundwater table was then measured at 2, 4, 6, and 8 hours at several locations along the length of the box.</p>
<div class="figure">
<img src="Fig/Example/Vauclin/best.png" alt="Simulation results from SHUD model versus Vauclin (1979) measurement" />
<p class="caption">Simulation results from SHUD model versus Vauclin (1979) measurement</p>
</div>
<p> also use 2-D (vertical and horizontal) numeric model to simulate the soil moisture and groundwater table. The maximum bias between measurement and simulation was $5.2 cm $, according to the value of digitalized in .</p>
<p>Besides the parameters specified in , additional information is needed by the SHUD, including the <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> in the van Genutchen equation and water content (<span class="math inline">\(\theta _s\)</span>). Therefore, we use a calibration tool to estimate the representative values of these parameters. The use of calibration in this simulation is reasonable because the model – inevitably – simplifies the real hydraulic processes. The calibration thus nudges the parameters to  values that approach or fit the  natural processes. The calibrated values are <span class="math inline">\(\theta _s = 0.32 m^3/m^3\)</span>, <span class="math inline">\(\alpha = 6.0\)</span> and <span class="math inline">\(\beta = 6.0\)</span>. Like the simulated results in  and , a mismatch exists between the simulations and measurements.</p>
<p>This mismatch may be due to (1) the aquifer description of unsaturated and saturated layers limiting the capability to simulate infiltration and recharge in the unsaturated zone, or (2) the horizontal unsaturated flow assumptions no longer hold at the relatively microscopic scales of this experiment.</p>
<p>The SHUD simulated the groundwater table at all four measurement points (see Fig. (b). The maximum bias between simulation and Vauclin’s observations is $ 5.5cm$, with <span class="math inline">\(R^2\)</span> = <span class="math inline">\(0.99\)</span>, that is comparable to the bias <span class="math inline">\(5.2 cm\)</span> of numerical simulation in . When the calibration takes more soil parameters into account, the bias in simulation decreases to <span class="math inline">\(3 cm\)</span>. Certainly, the simplifications employed by SHUD for the unsaturated and saturated zone benefits the computation efficiency while limiting the applicability of the model for micro-scale problems.</p>
<p>The simulations, compared against Vauclin’s experiment, validate the algorithm for infiltration, recharge, and lateral groundwater flow. More reliable vertical flow within unsaturated layer requires multiple layers, which is planned in next version of SHUD.</p>

</div>
<div id="example-3-cache-creek-watershed" class="section level2">
<h2><span class="header-section-number">5.3</span> Example 3: Cache Creek Watershed</h2>
<p>Code is available at <a href="https://zenodo.org/badge/latestdoi/226413148"><img src="https://zenodo.org/badge/226413148.svg" alt="DOI" /></a> and <a href="https://github.com/Model-Intercomparison-Datasets/Cache-Creek">Github: https://github.com/Model-Intercomparison-Datasets/Cache-Creek</a>. The data is big. If you need, please email to <a href="mailto:lele.shu@gmail.com">Lele Shu</a></p>
<div id="cache-creek-watershed" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Cache Creek Watershed</h3>
<p>The Cache Creek Watershed (CCW) is a headwater catchment with area <span class="math inline">\(196.4 km^2\)</span> in the Sacramento Watershed in Northern California (Figures  (a), (b) and (c)). The elevation ranges from <span class="math inline">\(450 m\)</span> to <span class="math inline">\(1800 m\)</span>, with a <span class="math inline">\(0.38 m/m\)</span> average slope which is very steep, and hence a particularly difficult watershed for hydrologic models to simulate.</p>
<div class="figure">
<img src="Fig/Example/CacheCreek/sac5_map.png" alt="Location and data for Cache Creek Watershed" />
<p class="caption">Location and data for Cache Creek Watershed</p>
</div>
<p>According to NLDAS-2, between 2000 and 2017 the mean temperature and precipitation was <span class="math inline">\(12.8 ^\circ C\)</span> and <span class="math inline">\(\approx 817 mm\)</span>, respectively, in this catchment. Precipitation is unevenly distributed through the year, with winter and spring precipitation being the vast majority of the contribution to the annual total (Fig. .</p>
<div class="figure">
<img src="Fig/Example/CacheCreek/sac5_PT.png" alt="Precipitation and temperature" />
<p class="caption">Precipitation and temperature</p>
</div>
</div>
<div id="shud-simulation-and-calibration" class="section level3">
<h3><span class="header-section-number">5.3.2</span> SHUD simulation and calibration</h3>
<p>Our simulation in CCW covers the period from 2000 to 2007. Because of the Mediterranean climate in this region, the simulation starts in summer to ensure adequate time before the October start to the water year. In our experiment, the first year (2000-06-01 to 2001-06-30) is the spin-up period, the following two years (2001-07-01 to 2003-06-30 ) are the calibration period, and the period from 2003-07-01 to 2007-07-01 is for validation.</p>
<p>The unstructured domain of the CCW (Fig.  (d)) is built with SHUDtoolbox, a R package on GitHub (<a href="https://github.com/shud-system/SHUDtoolbox">SHUDtoolbox</a>). The number of triangular cells is 1147, with a mean area of $ 0.17 km^2$. The total length of the river network is <span class="math inline">\(126.5 km\)</span> and consists of 103 river reaches and in which the highest order of stream is 4. With a calibrated parameter set, the SHUD model tooks 5 hours to simulate 17 years in the CCW, with a non-parallel configuration (OpenMP is disabled on <em>Mac Pro 2013 Xeon 2.7GHz, 32GB RAM</em>).</p>
</div>
<div id="results" class="section level3">
<h3><span class="header-section-number">5.3.3</span> Results</h3>
<p>Figure  reveals the comparison of simulated discharge against the observed discharge at the gage station of <a href="https://waterdata.usgs.gov/ca/nwis/uv/?site_no=11451100">USGS 11451100</a>. The calibration procedure exploits the Covariance Matrix Adaptation – Evolution Strategy (CMA-ES) to calibrate automatically . The calibration program assigns 72 children in each generation and keeps the best child as the seed for next-generation, with limited perturbations. The perturbation for the next generation is generated from the covariance matrix of the previous generation. After 23 generations, the calibration tool identifies a locally optimal parameter set.</p>
<div class="figure">
<img src="Fig/Example/CacheCreek/sac5_hydrograph_daily.png" alt="The hydrograph in calibration and validation period" />
<p class="caption">The hydrograph in calibration and validation period</p>
</div>
<p>We use the groundwater distribution (Fig. ) to demonstrate the spatial distribution of hydroligcal metrics calculated from the SHUD model.</p>
<p>Figure  illustrates the annual mean groundwater table in the validation period. Because the model fixes a <span class="math inline">\(30 m\)</span> aquifer, the results represent the groundwater within this aquifer only. The groundwater table and elevation along the green line on the upper map are extracted and plotted in the bottom figure. The gray ribbon is the <span class="math inline">\(30 m\)</span> aquifer, and the blue line is the location where groundwater storage is larger than zero. The green polygons with the right axis are the groundwater storage along the cross-section. The groundwater follows the terrain, with groundwater accumulated in the valley, or along relatively flat plains. In the CCW, the groundwater is very deep or does not stay on the steep slope.</p>
<div class="figure">
<img src="Fig/Example/CacheCreek/sac5_rgw.png" alt="Groundwater spatial distribution map" />
<p class="caption">Groundwater spatial distribution map</p>
</div>
<div class="figure">
<img src="Fig/Example/CacheCreek/sac5_sgw.png" alt="The groundwater condition along the cross-section line" />
<p class="caption">The groundwater condition along the cross-section line</p>
</div>
<div class="figure">
<img src="Fig/Example/CacheCreek/sac5_wb.png" alt="Water balance in the simulation period" />
<p class="caption">Water balance in the simulation period</p>
</div>

</div>
</div>
<div id="example-4-flashy-flood-in-yanhua-village-ningxia-china-on-september-2018" class="section level2">
<h2><span class="header-section-number">5.4</span> Example 4: Flashy flood in Yanhua Village, Ningxia, China on September 2018</h2>
<div class="figure">
<img src="Fig/Example/Yanhuacun/sun.jpg" alt="The Sun God of Perietal Art (Source: wiki)" />
<p class="caption">The Sun God of Perietal Art (Source: wiki)</p>
</div>
<div class="figure">
<img src="Fig/Example/Yanhuacun/map.png" alt="Triangular modeling domain of the Yanhua Village)" />
<p class="caption">Triangular modeling domain of the Yanhua Village)</p>
</div>

</div>
<div id="example-5-flood-inundation-in-houston-during-harvey-hurricane-2017" class="section level2">
<h2><span class="header-section-number">5.5</span> Example 5: Flood inundation in Houston during Harvey Hurricane 2017</h2>

</div>
<div id="example-6-watershed-in-south-sudan" class="section level2">
<h2><span class="header-section-number">5.6</span> Example 6: Watershed in South Sudan</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="output-files.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="calibration.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["SHUD_User_Guide.pdf", "SHUD_User_Guide.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
